Using a slow image processor as `use_fast` is unset and a slow processor was saved with this model. `use_fast=True` will be the default behavior in v4.48, even if the model was saved with a slow processor. This will result in minor differences in outputs. You'll still be able to use a slow processor with `use_fast=False`.
Some weights of the model checkpoint at facebook/detr-resnet-50 were not used when initializing DetrForObjectDetection: ['model.backbone.conv_encoder.model.layer1.0.downsample.1.num_batches_tracked', 'model.backbone.conv_encoder.model.layer2.0.downsample.1.num_batches_tracked', 'model.backbone.conv_encoder.model.layer3.0.downsample.1.num_batches_tracked', 'model.backbone.conv_encoder.model.layer4.0.downsample.1.num_batches_tracked']
- This IS expected if you are initializing DetrForObjectDetection from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing DetrForObjectDetection from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
/scratch/general/vast/u1475870/photonode/object_detection.py:109: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  0%|          | 0/180 [00:00<?, ?it/s]The `max_size` parameter is deprecated and will be removed in v4.26. Please specify in `size['longest_edge'] instead`.
  1%|          | 1/180 [00:09<28:41,  9.62s/it]  1%|          | 2/180 [00:15<21:16,  7.17s/it]  2%|▏         | 3/180 [00:18<16:43,  5.67s/it]  2%|▏         | 4/180 [00:24<16:20,  5.57s/it]  3%|▎         | 5/180 [00:30<17:20,  5.94s/it]  3%|▎         | 6/180 [00:33<14:16,  4.92s/it]  4%|▍         | 7/180 [00:38<14:09,  4.91s/it]  4%|▍         | 8/180 [00:43<13:59,  4.88s/it]  5%|▌         | 9/180 [00:49<14:26,  5.07s/it]  6%|▌         | 10/180 [00:52<12:27,  4.40s/it]  6%|▌         | 11/180 [00:56<12:35,  4.47s/it]  7%|▋         | 12/180 [01:01<12:59,  4.64s/it]  7%|▋         | 13/180 [01:07<13:42,  4.92s/it]  8%|▊         | 14/180 [01:12<13:57,  5.05s/it]  8%|▊         | 15/180 [01:17<13:47,  5.02s/it]  9%|▉         | 16/180 [01:21<12:39,  4.63s/it]  9%|▉         | 17/180 [01:23<10:30,  3.87s/it] 10%|█         | 18/180 [01:23<07:31,  2.79s/it] 11%|█         | 19/180 [01:32<12:14,  4.56s/it] 11%|█         | 20/180 [01:37<12:19,  4.62s/it] 12%|█▏        | 21/180 [01:42<12:54,  4.87s/it] 12%|█▏        | 22/180 [01:47<12:34,  4.78s/it] 13%|█▎        | 23/180 [01:51<12:30,  4.78s/it] 13%|█▎        | 24/180 [01:57<13:04,  5.03s/it] 14%|█▍        | 25/180 [02:00<11:35,  4.49s/it] 14%|█▍        | 26/180 [02:04<10:49,  4.21s/it] 15%|█▌        | 27/180 [02:07<10:20,  4.06s/it] 16%|█▌        | 28/180 [02:14<11:59,  4.74s/it] 16%|█▌        | 29/180 [02:19<12:28,  4.96s/it] 17%|█▋        | 30/180 [02:25<12:44,  5.10s/it] 17%|█▋        | 31/180 [02:31<13:24,  5.40s/it] 18%|█▊        | 32/180 [02:36<13:16,  5.38s/it] 18%|█▊        | 33/180 [02:42<13:38,  5.57s/it] 19%|█▉        | 34/180 [02:45<11:52,  4.88s/it] 19%|█▉        | 35/180 [02:46<08:50,  3.66s/it] 20%|██        | 36/180 [02:47<06:20,  2.64s/it] 21%|██        | 37/180 [02:55<10:27,  4.39s/it] 21%|██        | 38/180 [03:01<11:37,  4.91s/it] 22%|██▏       | 39/180 [03:06<11:21,  4.83s/it] 22%|██▏       | 40/180 [03:10<11:06,  4.76s/it] 23%|██▎       | 41/180 [03:14<10:14,  4.42s/it] 23%|██▎       | 42/180 [03:18<10:12,  4.44s/it] 24%|██▍       | 43/180 [03:23<10:26,  4.57s/it] 24%|██▍       | 44/180 [03:28<10:18,  4.55s/it] 25%|██▌       | 45/180 [03:32<10:12,  4.53s/it] 26%|██▌       | 46/180 [03:37<10:17,  4.61s/it] 26%|██▌       | 47/180 [03:41<09:50,  4.44s/it] 27%|██▋       | 48/180 [03:45<09:09,  4.17s/it] 27%|██▋       | 49/180 [03:49<09:26,  4.33s/it] 28%|██▊       | 50/180 [03:56<11:07,  5.14s/it]                                                 28%|██▊       | 50/180 [03:56<11:07,  5.14s/it] 28%|██▊       | 51/180 [04:01<10:59,  5.11s/it] 29%|██▉       | 52/180 [04:08<11:35,  5.43s/it] 29%|██▉       | 53/180 [04:09<09:04,  4.29s/it] 30%|███       | 54/180 [04:10<06:28,  3.09s/it] 31%|███       | 55/180 [04:19<10:07,  4.86s/it] 31%|███       | 56/180 [04:23<09:50,  4.76s/it] 32%|███▏      | 57/180 [04:30<10:48,  5.27s/it] 32%|███▏      | 58/180 [04:34<10:26,  5.13s/it] 33%|███▎      | 59/180 [04:39<10:16,  5.10s/it] 33%|███▎      | 60/180 [04:45<10:26,  5.22s/it] 34%|███▍      | 61/180 [04:49<09:33,  4.82s/it] 34%|███▍      | 62/180 [04:54<09:30,  4.84s/it] 35%|███▌      | 63/180 [05:00<10:09,  5.21s/it] 36%|███▌      | 64/180 [05:05<10:11,  5.28s/it] 36%|███▌      | 65/180 [05:11<10:27,  5.45s/it] 37%|███▋      | 66/180 [05:15<09:31,  5.01s/it] 37%|███▋      | 67/180 [05:19<08:59,  4.77s/it] 38%|███▊      | 68/180 [05:23<08:33,  4.59s/it] 38%|███▊      | 69/180 [05:26<07:26,  4.02s/it] 39%|███▉      | 70/180 [05:30<07:17,  3.98s/it] 39%|███▉      | 71/180 [05:32<06:16,  3.46s/it] 40%|████      | 72/180 [05:32<04:30,  2.50s/it] 41%|████      | 73/180 [05:42<08:11,  4.59s/it] 41%|████      | 74/180 [05:46<07:56,  4.50s/it] 42%|████▏     | 75/180 [05:53<09:00,  5.15s/it] 42%|████▏     | 76/180 [05:57<08:24,  4.85s/it] 43%|████▎     | 77/180 [06:00<07:35,  4.42s/it] 43%|████▎     | 78/180 [06:05<07:25,  4.37s/it] 44%|████▍     | 79/180 [06:07<06:26,  3.83s/it] 44%|████▍     | 80/180 [06:14<07:50,  4.70s/it] 45%|████▌     | 81/180 [06:20<08:13,  4.99s/it] 46%|████▌     | 82/180 [06:25<08:21,  5.12s/it] 46%|████▌     | 83/180 [06:32<09:14,  5.72s/it] 47%|████▋     | 84/180 [06:37<08:29,  5.31s/it] 47%|████▋     | 85/180 [06:40<07:38,  4.82s/it] 48%|████▊     | 86/180 [06:45<07:39,  4.89s/it] 48%|████▊     | 87/180 [06:50<07:25,  4.80s/it] 49%|████▉     | 88/180 [06:53<06:36,  4.31s/it] 49%|████▉     | 89/180 [06:55<05:39,  3.73s/it] 50%|█████     | 90/180 [06:56<04:02,  2.69s/it] 51%|█████     | 91/180 [07:06<07:30,  5.06s/it] 51%|█████     | 92/180 [07:10<06:38,  4.53s/it] 52%|█████▏    | 93/180 [07:14<06:30,  4.49s/it] 52%|█████▏    | 94/180 [07:18<06:22,  4.45s/it] 53%|█████▎    | 95/180 [07:23<06:31,  4.61s/it] 53%|█████▎    | 96/180 [07:28<06:40,  4.77s/it] 54%|█████▍    | 97/180 [07:33<06:37,  4.79s/it] 54%|█████▍    | 98/180 [07:38<06:22,  4.66s/it] 55%|█████▌    | 99/180 [07:44<07:01,  5.20s/it] 56%|█████▌    | 100/180 [07:48<06:23,  4.79s/it]                                                  56%|█████▌    | 100/180 [07:48<06:23,  4.79s/it] 56%|█████▌    | 101/180 [07:52<06:10,  4.69s/it] 57%|█████▋    | 102/180 [07:58<06:17,  4.84s/it] 57%|█████▋    | 103/180 [08:02<05:58,  4.66s/it] 58%|█████▊    | 104/180 [08:08<06:36,  5.22s/it] 58%|█████▊    | 105/180 [08:14<06:31,  5.23s/it] 59%|█████▉    | 106/180 [08:17<05:41,  4.61s/it] 59%|█████▉    | 107/180 [08:18<04:27,  3.66s/it] 60%|██████    | 108/180 [08:19<03:10,  2.65s/it] 61%|██████    | 109/180 [08:29<05:49,  4.92s/it] 61%|██████    | 110/180 [08:34<05:47,  4.97s/it] 62%|██████▏   | 111/180 [08:38<05:34,  4.84s/it] 62%|██████▏   | 112/180 [08:44<05:41,  5.02s/it] 63%|██████▎   | 113/180 [08:47<05:08,  4.61s/it] 63%|██████▎   | 114/180 [08:54<05:38,  5.13s/it] 64%|██████▍   | 115/180 [08:57<05:01,  4.64s/it] 64%|██████▍   | 116/180 [09:02<05:01,  4.71s/it] 65%|██████▌   | 117/180 [09:07<05:07,  4.87s/it] 66%|██████▌   | 118/180 [09:12<04:47,  4.64s/it] 66%|██████▌   | 119/180 [09:15<04:21,  4.28s/it] 67%|██████▋   | 120/180 [09:18<03:50,  3.84s/it] 67%|██████▋   | 121/180 [09:25<04:40,  4.76s/it] 68%|██████▊   | 122/180 [09:30<04:49,  4.98s/it] 68%|██████▊   | 123/180 [09:35<04:39,  4.90s/it] 69%|██████▉   | 124/180 [09:39<04:27,  4.78s/it] 69%|██████▉   | 125/180 [09:41<03:37,  3.95s/it] 70%|███████   | 126/180 [09:42<02:33,  2.85s/it] 71%|███████   | 127/180 [09:51<04:15,  4.82s/it] 71%|███████   | 128/180 [09:54<03:45,  4.33s/it] 72%|███████▏  | 129/180 [10:00<03:54,  4.60s/it] 72%|███████▏  | 130/180 [10:05<03:58,  4.76s/it] 73%|███████▎  | 131/180 [10:08<03:37,  4.44s/it] 73%|███████▎  | 132/180 [10:12<03:24,  4.25s/it] 74%|███████▍  | 133/180 [10:17<03:24,  4.35s/it] 74%|███████▍  | 134/180 [10:21<03:12,  4.18s/it] 75%|███████▌  | 135/180 [10:26<03:21,  4.48s/it] 76%|███████▌  | 136/180 [10:29<03:05,  4.23s/it] 76%|███████▌  | 137/180 [10:36<03:27,  4.82s/it] 77%|███████▋  | 138/180 [10:40<03:16,  4.67s/it] 77%|███████▋  | 139/180 [10:46<03:28,  5.09s/it] 78%|███████▊  | 140/180 [10:50<03:12,  4.81s/it] 78%|███████▊  | 141/180 [10:58<03:41,  5.67s/it] 79%|███████▉  | 142/180 [11:02<03:20,  5.27s/it] 79%|███████▉  | 143/180 [11:04<02:40,  4.34s/it] 80%|████████  | 144/180 [11:05<01:52,  3.12s/it] 81%|████████  | 145/180 [11:14<02:52,  4.93s/it] 81%|████████  | 146/180 [11:17<02:33,  4.53s/it] 82%|████████▏ | 147/180 [11:22<02:31,  4.58s/it] 82%|████████▏ | 148/180 [11:28<02:44,  5.13s/it] 83%|████████▎ | 149/180 [11:33<02:35,  5.01s/it] 83%|████████▎ | 150/180 [11:36<02:10,  4.36s/it]                                                  83%|████████▎ | 150/180 [11:36<02:10,  4.36s/it] 84%|████████▍ | 151/180 [11:41<02:11,  4.52s/it] 84%|████████▍ | 152/180 [11:48<02:29,  5.35s/it] 85%|████████▌ | 153/180 [11:52<02:14,  4.97s/it] 86%|████████▌ | 154/180 [11:56<01:55,  4.46s/it] 86%|████████▌ | 155/180 [12:01<02:01,  4.88s/it] 87%|████████▋ | 156/180 [12:08<02:06,  5.26s/it] 87%|████████▋ | 157/180 [12:10<01:41,  4.41s/it] 88%|████████▊ | 158/180 [12:15<01:40,  4.59s/it] 88%|████████▊ | 159/180 [12:20<01:39,  4.76s/it] 89%|████████▉ | 160/180 [12:25<01:36,  4.84s/it] 89%|████████▉ | 161/180 [12:27<01:13,  3.85s/it] 90%|█████████ | 162/180 [12:27<00:50,  2.78s/it] 91%|█████████ | 163/180 [12:35<01:12,  4.27s/it] 91%|█████████ | 164/180 [12:40<01:11,  4.47s/it] 92%|█████████▏| 165/180 [12:45<01:10,  4.70s/it] 92%|█████████▏| 166/180 [12:50<01:09,  4.96s/it] 93%|█████████▎| 167/180 [12:54<00:58,  4.47s/it] 93%|█████████▎| 168/180 [12:58<00:54,  4.50s/it] 94%|█████████▍| 169/180 [13:03<00:51,  4.68s/it] 94%|█████████▍| 170/180 [13:07<00:43,  4.32s/it] 95%|█████████▌| 171/180 [13:11<00:36,  4.09s/it] 96%|█████████▌| 172/180 [13:16<00:34,  4.37s/it] 96%|█████████▌| 173/180 [13:21<00:33,  4.75s/it] 97%|█████████▋| 174/180 [13:26<00:28,  4.69s/it] 97%|█████████▋| 175/180 [13:31<00:23,  4.78s/it] 98%|█████████▊| 176/180 [13:36<00:19,  4.81s/it] 98%|█████████▊| 177/180 [13:41<00:15,  5.05s/it] 99%|█████████▉| 178/180 [13:47<00:10,  5.37s/it] 99%|█████████▉| 179/180 [13:49<00:04,  4.37s/it]100%|██████████| 180/180 [13:50<00:00,  3.15s/it]                                                 100%|██████████| 180/180 [13:51<00:00,  3.15s/it]100%|██████████| 180/180 [13:51<00:00,  4.62s/it]
{'loss': 7.8344, 'grad_norm': 53.19257354736328, 'learning_rate': 7.555555555555556e-06, 'epoch': 2.78}
{'loss': 4.936, 'grad_norm': 8.476208686828613, 'learning_rate': 4.888888888888889e-06, 'epoch': 5.56}
{'loss': 4.0847, 'grad_norm': 17.163183212280273, 'learning_rate': 2.222222222222222e-06, 'epoch': 8.33}
{'train_runtime': 831.9548, 'train_samples_per_second': 1.671, 'train_steps_per_second': 0.216, 'train_loss': 5.349935785929362, 'epoch': 10.0}
Model successfully trained
